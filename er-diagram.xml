<mxfile host="app.diagrams.net">
  <diagram name="Page-1" id="RZPy7LJ9Z-LHqu28oYYm">
    <mxGraphModel dx="1462" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- ЗАГОЛОВОК -->
        <mxCell id="title" value="&lt;b&gt;ER-ДИАГРАММА БАЗЫ ДАННЫХ &amp;quot;ДОМАШНЯЯ БИБЛИОТЕКА&amp;quot;&lt;/b&gt;&lt;br&gt;&lt;font style='font-size: 12px'&gt;(упрощенная версия)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="300" y="20" width="250" height="40" as="geometry" />
        </mxCell>
        
        <!-- ============ СПРАВОЧНЫЕ ТАБЛИЦЫ (СЛЕВА) ============ -->
        
        <!-- AGE_RATINGS -->
        <mxCell id="age_ratings" value="&lt;b&gt;AGE_RATINGS&lt;/b&gt;&lt;br&gt;(возрастные рейтинги)&lt;hr&gt;&lt;u&gt;id&lt;/u&gt; PK&lt;br&gt;code VARCHAR&lt;br&gt;min_age INTEGER&lt;br&gt;description TEXT" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="50" y="80" width="160" height="110" as="geometry" />
        </mxCell>
        
        <!-- GENRES -->
        <mxCell id="genres" value="&lt;b&gt;GENRES&lt;/b&gt;&lt;br&gt;(жанры)&lt;hr&gt;&lt;u&gt;id&lt;/u&gt; PK&lt;br&gt;name VARCHAR&lt;br&gt;description TEXT" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="50" y="210" width="160" height="90" as="geometry" />
        </mxCell>
        
        <!-- LOCATIONS -->
        <mxCell id="locations" value="&lt;b&gt;LOCATIONS&lt;/b&gt;&lt;br&gt;(места хранения)&lt;hr&gt;&lt;u&gt;id&lt;/u&gt; PK&lt;br&gt;room VARCHAR&lt;br&gt;furniture VARCHAR&lt;br&gt;shelf VARCHAR" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="50" y="320" width="160" height="100" as="geometry" />
        </mxCell>
        
        <!-- ============ ОСНОВНЫЕ ТАБЛИЦЫ (ЦЕНТР) ============ -->
        
        <!-- BOOKS -->
        <mxCell id="books" value="&lt;b&gt;BOOKS&lt;/b&gt;&lt;br&gt;(книги)&lt;hr&gt;&lt;u&gt;id&lt;/u&gt; PK&lt;br&gt;title VARCHAR NOT NULL&lt;br&gt;publication_year INTEGER&lt;br&gt;publisher VARCHAR&lt;br&gt;&lt;b&gt;age_rating_id&lt;/b&gt; FK&lt;br&gt;isbn VARCHAR" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="260" y="80" width="160" height="120" as="geometry" />
        </mxCell>
        
        <!-- AUTHORS -->
        <mxCell id="authors" value="&lt;b&gt;AUTHORS&lt;/b&gt;&lt;br&gt;(авторы)&lt;hr&gt;&lt;u&gt;id&lt;/u&gt; PK&lt;br&gt;last_name VARCHAR&lt;br&gt;first_name VARCHAR&lt;br&gt;birth_year INTEGER&lt;br&gt;country VARCHAR&lt;br&gt;special_notes TEXT" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="260" y="220" width="160" height="120" as="geometry" />
        </mxCell>
        
        <!-- USERS -->
        <mxCell id="users" value="&lt;b&gt;USERS&lt;/b&gt;&lt;br&gt;(пользователи)&lt;hr&gt;&lt;u&gt;id&lt;/u&gt; PK&lt;br&gt;last_name VARCHAR NOT NULL&lt;br&gt;first_name VARCHAR NOT NULL&lt;br&gt;&lt;b&gt;birth_date&lt;/b&gt; DATE NOT NULL&lt;br&gt;email VARCHAR&lt;br&gt;role VARCHAR" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="260" y="360" width="160" height="120" as="geometry" />
        </mxCell>
        
        <!-- COPIES -->
        <mxCell id="copies" value="&lt;b&gt;COPIES&lt;/b&gt;&lt;br&gt;(экземпляры)&lt;hr&gt;&lt;u&gt;id&lt;/u&gt; PK&lt;br&gt;&lt;b&gt;book_id&lt;/b&gt; FK&lt;br&gt;inventory_number VARCHAR&lt;br&gt;&lt;b&gt;location_id&lt;/b&gt; FK&lt;br&gt;condition VARCHAR&lt;br&gt;is_available BOOLEAN" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="260" y="500" width="160" height="120" as="geometry" />
        </mxCell>
        
        <!-- ============ СВЯЗУЮЩИЕ ТАБЛИЦЫ (СПРАВА) ============ -->
        
        <!-- BOOK_AUTHORS -->
        <mxCell id="book_authors" value="&lt;b&gt;BOOK_AUTHORS&lt;/b&gt;&lt;br&gt;(авторы книг)&lt;hr&gt;&lt;u&gt;id&lt;/u&gt; PK&lt;br&gt;&lt;b&gt;book_id&lt;/b&gt; FK&lt;br&gt;&lt;b&gt;author_id&lt;/b&gt; FK&lt;br&gt;author_order INTEGER" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="470" y="100" width="160" height="90" as="geometry" />
        </mxCell>
        
        <!-- BOOK_GENRES -->
        <mxCell id="book_genres" value="&lt;b&gt;BOOK_GENRES&lt;/b&gt;&lt;br&gt;(жанры книг)&lt;hr&gt;&lt;u&gt;id&lt;/u&gt; PK&lt;br&gt;&lt;b&gt;book_id&lt;/b&gt; FK&lt;br&gt;&lt;b&gt;genre_id&lt;/b&gt; FK" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="470" y="210" width="160" height="80" as="geometry" />
        </mxCell>
        
        <!-- LOANS -->
        <mxCell id="loans" value="&lt;b&gt;LOANS&lt;/b&gt;&lt;br&gt;(выдача книг)&lt;hr&gt;&lt;u&gt;id&lt;/u&gt; PK&lt;br&gt;&lt;b&gt;copy_id&lt;/b&gt; FK&lt;br&gt;&lt;b&gt;user_id&lt;/b&gt; FK&lt;br&gt;loan_date DATE&lt;br&gt;due_date DATE&lt;br&gt;return_date DATE&lt;br&gt;age_check_passed BOOLEAN" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="470" y="310" width="160" height="120" as="geometry" />
        </mxCell>
        
        <!-- ============ СВЯЗИ ============ -->
        
        <!-- BOOKS → AGE_RATINGS -->
        <mxCell id="link1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="books" target="age_ratings">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="370" y="140" as="sourcePoint" />
            <mxPoint x="210" y="140" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="link1_label" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="link1">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- BOOKS ↔ AUTHORS -->
        <mxCell id="link2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="books" target="book_authors">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="link2_1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="book_authors" target="authors">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="link2_label" value="*" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="link2_1">
          <mxGeometry x="0.1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- BOOKS ↔ GENRES -->
        <mxCell id="link3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.8;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="books" target="book_genres">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="link3_1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="book_genres" target="genres">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- BOOKS → COPIES -->
        <mxCell id="link4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="books" target="copies">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="link4_label" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="link4">
          <mxGeometry x="0.5" y="-0.3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="link4_label2" value="*" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="link4">
          <mxGeometry x="0.5" y="1.3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- COPIES → LOCATIONS -->
        <mxCell id="link5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="copies" target="locations">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="200" y="560" />
              <mxPoint x="200" y="370" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- COPIES → LOANS -->
        <mxCell id="link6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.3;entryDx=0;entryDy=0;" edge="1" parent="1" source="copies" target="loans">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="link6_label" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="link6">
          <mxGeometry x="-0.1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="link6_label2" value="*" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="link6">
          <mxGeometry x="1.1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- USERS → LOANS -->
        <mxCell id="link7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.7;entryDx=0;entryDy=0;" edge="1" parent="1" source="users" target="loans">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="link7_label" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="link7">
          <mxGeometry x="-0.1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="link7_label2" value="*" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="link7">
          <mxGeometry x="1.1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- ЛЕГЕНДА -->
        <mxCell id="legend" value="&lt;b&gt;УСЛОВНЫЕ ОБОЗНАЧЕНИЯ&lt;/b&gt;&lt;hr&gt;&lt;b&gt;ЦВЕТА:&lt;/b&gt;&lt;br&gt;█ Справочные таблицы&lt;br&gt;█ Основные таблицы&lt;br&gt;█ Связующие таблицы&lt;br&gt;█ Операционные таблицы&lt;br&gt;&lt;br&gt;&lt;b&gt;ОБОЗНАЧЕНИЯ:&lt;/b&gt;&lt;br&gt;PK - Первичный ключ&lt;br&gt;FK - Внешний ключ&lt;br&gt;1 - один (обязательно)&lt;br&gt;* - много (0..*)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="470" y="450" width="160" height="150" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
